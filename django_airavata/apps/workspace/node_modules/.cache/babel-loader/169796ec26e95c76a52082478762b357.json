{"remainingRequest":"/home/vanishing/git/airavata-django-portal/django_airavata/apps/workspace/node_modules/thread-loader/dist/cjs.js!/home/vanishing/git/airavata-django-portal/django_airavata/apps/workspace/node_modules/babel-loader/lib/index.js!/home/vanishing/git/airavata-django-portal/django_airavata/apps/workspace/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/vanishing/git/airavata-django-portal/django_airavata/apps/workspace/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vanishing/git/airavata-django-portal/django_airavata/apps/workspace/static/django_airavata_workspace/js/components/experiment/input-editors/FileInputEditor.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vanishing/git/airavata-django-portal/django_airavata/apps/workspace/static/django_airavata_workspace/js/components/experiment/input-editors/FileInputEditor.vue","mtime":1638641844339},{"path":"/home/vanishing/git/airavata-django-portal/django_airavata/apps/workspace/node_modules/babel-loader/lib/index.js","mtime":1638646225600},{"path":"/home/vanishing/git/airavata-django-portal/django_airavata/apps/workspace/node_modules/cache-loader/dist/cjs.js","mtime":1638646228487},{"path":"/home/vanishing/git/airavata-django-portal/django_airavata/apps/workspace/node_modules/vue-loader/lib/index.js","mtime":1638646228900},{"path":"/home/vanishing/git/airavata-django-portal/django_airavata/apps/workspace/node_modules/cache-loader/dist/cjs.js","mtime":1638646228487},{"path":"/home/vanishing/git/airavata-django-portal/django_airavata/apps/workspace/node_modules/thread-loader/dist/cjs.js","mtime":1638646228889},{"path":"/home/vanishing/git/airavata-django-portal/django_airavata/apps/workspace/node_modules/babel-loader/lib/index.js","mtime":1638646225600},{"path":"/home/vanishing/git/airavata-django-portal/django_airavata/apps/workspace/node_modules/cache-loader/dist/cjs.js","mtime":1638646228487},{"path":"/home/vanishing/git/airavata-django-portal/django_airavata/apps/workspace/node_modules/vue-loader/lib/index.js","mtime":1638646228900}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.split\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { models, services, utils } from \"django-airavata-api\";\nimport { InputEditorMixin } from \"django-airavata-workspace-plugin-api\";\nimport { components } from \"django-airavata-common-ui\";\nimport InputFileSelector from \"./InputFileSelector\";\nimport UserStorageLink from \"../../storage/storage-edit/UserStorageLink\";\nexport default {\n  name: \"file-input-editor\",\n  mixins: [InputEditorMixin],\n  components: {\n    UserStorageLink,\n    \"delete-link\": components.DeleteLink,\n    InputFileSelector\n  },\n  computed: {\n    isDataProductURI() {\n      // Just assume that if the value is a string then it's a data product URL\n      return this.value && typeof this.value === \"string\" && this.value.startsWith(\"airavata-dp://\");\n    },\n\n    // When used in the MultiFileInputEditor, don't allow selecting the same\n    // file more than once. This computed property creates an array of already\n    // selected files.\n    selectedDataProductURIs() {\n      if (this.experimentInput.type === models.DataType.URI_COLLECTION && this.experimentInput.value) {\n        return this.experimentInput.value.split(\",\");\n      } else {\n        return [];\n      }\n    },\n\n    isViewable() {\n      return this.dataProduct.isText;\n    }\n\n  },\n\n  data() {\n    return {\n      dataProduct: null,\n      fileContent: null,\n      uploading: false\n    };\n  },\n\n  created() {\n    if (this.isDataProductURI) {\n      this.loadDataProduct(this.value);\n    }\n  },\n\n  methods: {\n    loadDataProduct(dataProductURI) {\n      services.DataProductService.retrieve({\n        lookup: dataProductURI\n      }).then(dataProduct => this.dataProduct = dataProduct).catch(() => {\n        // If we're unable to load data product, reset data to null\n        this.data = null;\n        this.valueChanged();\n      });\n    },\n\n    deleteDataProduct() {\n      utils.FetchUtils.delete(\"/api/delete-file?data-product-uri=\" + encodeURIComponent(this.value), {\n        ignoreErrors: true\n      }).then(() => {\n        this.data = null;\n        this.valueChanged();\n      }).catch(err => {\n        // Ignore 404 Not Found errors, file no longer exists so assume was\n        // already deleted\n        if (err.details.status === 404) {\n          this.data = null;\n          this.valueChanged();\n        } else {\n          throw err;\n        }\n      }).catch(utils.FetchUtils.reportError);\n    },\n\n    unselect() {\n      this.data = null;\n      this.valueChanged();\n    },\n\n    fileSelected(dataProductURI, dataProduct) {\n      this.data = dataProductURI;\n\n      if (!dataProduct) {\n        this.loadDataProduct(dataProductURI);\n      } else {\n        this.dataProduct = dataProduct;\n      }\n\n      this.valueChanged();\n    },\n\n    uploadStart() {\n      this.uploading = true;\n      this.$emit(\"uploadstart\");\n    },\n\n    uploadEnd() {\n      this.uploading = false;\n      this.$emit(\"uploadend\");\n    }\n\n  },\n  watch: {\n    value(value, oldValue) {\n      if (this.isDataProductURI && value !== oldValue) {\n        this.loadDataProduct(value);\n      }\n    }\n\n  }\n};",{"version":3,"sources":["FileInputEditor.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"file-input-editor\">\n    <div class=\"d-flex\" v-if=\"isDataProductURI && dataProduct\">\n      <user-storage-link\n        class=\"mr-auto\"\n        :data-product-uri=\"dataProduct.productUri\"\n        :mime-type=\"dataProduct.mimeType\"\n        :file-name=\"dataProduct.productName\"\n      />\n      <delete-link\n        v-if=\"!readOnly && dataProduct.isInputFileUpload\"\n        class=\"ml-2\"\n        @delete=\"deleteDataProduct\"\n      >\n        Are you sure you want to delete input file\n        <strong>{{ dataProduct.productName }}</strong\n        >?\n      </delete-link>\n      <b-link\n        v-else-if=\"!readOnly\"\n        @click=\"unselect\"\n        class=\"ml-2 text-secondary\"\n      >\n        Unselect\n        <i class=\"fa fa-times\" aria-hidden=\"true\"></i>\n      </b-link>\n    </div>\n    <input-file-selector\n      v-if=\"!readOnly && (!isDataProductURI || uploading)\"\n      :selectedDataProductURIs=\"selectedDataProductURIs\"\n      @uploadstart=\"uploadStart\"\n      @uploadend=\"uploadEnd\"\n      @selected=\"fileSelected\"\n    />\n  </div>\n</template>\n\n<script>\nimport {models, services, utils} from \"django-airavata-api\";\nimport {InputEditorMixin} from \"django-airavata-workspace-plugin-api\";\nimport {components} from \"django-airavata-common-ui\";\nimport InputFileSelector from \"./InputFileSelector\";\nimport UserStorageLink from \"../../storage/storage-edit/UserStorageLink\";\n\nexport default {\n  name: \"file-input-editor\",\n  mixins: [InputEditorMixin],\n  components: {\n    UserStorageLink,\n    \"delete-link\": components.DeleteLink,\n    InputFileSelector\n  },\n  computed: {\n    isDataProductURI() {\n      // Just assume that if the value is a string then it's a data product URL\n      return (\n        this.value &&\n        typeof this.value === \"string\" &&\n        this.value.startsWith(\"airavata-dp://\")\n      );\n    },\n    // When used in the MultiFileInputEditor, don't allow selecting the same\n    // file more than once. This computed property creates an array of already\n    // selected files.\n    selectedDataProductURIs() {\n      if (\n        this.experimentInput.type === models.DataType.URI_COLLECTION &&\n        this.experimentInput.value\n      ) {\n        return this.experimentInput.value.split(\",\");\n      } else {\n        return [];\n      }\n    },\n    isViewable() {\n      return this.dataProduct.isText;\n    },\n  },\n  data() {\n    return {\n      dataProduct: null,\n      fileContent: null,\n      uploading: false,\n    };\n  },\n  created() {\n    if (this.isDataProductURI) {\n      this.loadDataProduct(this.value);\n    }\n  },\n  methods: {\n    loadDataProduct(dataProductURI) {\n      services.DataProductService.retrieve({lookup: dataProductURI})\n        .then((dataProduct) => (this.dataProduct = dataProduct))\n        .catch(() => {\n          // If we're unable to load data product, reset data to null\n          this.data = null;\n          this.valueChanged();\n        });\n    },\n    deleteDataProduct() {\n      utils.FetchUtils.delete(\n        \"/api/delete-file?data-product-uri=\" + encodeURIComponent(this.value),\n        {ignoreErrors: true}\n      )\n        .then(() => {\n          this.data = null;\n          this.valueChanged();\n        })\n        .catch((err) => {\n          // Ignore 404 Not Found errors, file no longer exists so assume was\n          // already deleted\n          if (err.details.status === 404) {\n            this.data = null;\n            this.valueChanged();\n          } else {\n            throw err;\n          }\n        })\n        .catch(utils.FetchUtils.reportError);\n    },\n    unselect() {\n      this.data = null;\n      this.valueChanged();\n    },\n    fileSelected(dataProductURI, dataProduct) {\n      this.data = dataProductURI;\n      if (!dataProduct) {\n        this.loadDataProduct(dataProductURI);\n      } else {\n        this.dataProduct = dataProduct;\n      }\n      this.valueChanged();\n    },\n    uploadStart() {\n      this.uploading = true;\n      this.$emit(\"uploadstart\");\n    },\n    uploadEnd() {\n      this.uploading = false;\n      this.$emit(\"uploadend\");\n    },\n  },\n  watch: {\n    value(value, oldValue) {\n      if (this.isDataProductURI && value !== oldValue) {\n        this.loadDataProduct(value);\n      }\n    }\n  }\n};\n</script>\n\n<style scoped>\n.input-file-option {\n  flex: 1 1 50%;\n}\n</style>\n"],"sourceRoot":"static/django_airavata_workspace/js/components/experiment/input-editors"}]}