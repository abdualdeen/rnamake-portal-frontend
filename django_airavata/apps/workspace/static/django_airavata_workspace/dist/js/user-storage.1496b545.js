(function(t){function e(e){for(var a,i,s=e[0],u=e[1],c=e[2],d=0,l=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&l.push(n[i][0]),n[i]=0;for(a in u)Object.prototype.hasOwnProperty.call(u,a)&&(t[a]=u[a]);h&&h(e);while(l.length)l.shift()();return o.push.apply(o,c||[]),r()}function r(){for(var t,e=0;e<o.length;e++){for(var r=o[e],a=!0,s=1;s<r.length;s++){var u=r[s];0!==n[u]&&(a=!1)}a&&(o.splice(e--,1),t=i(i.s=r[0]))}return t}var a={},n={"user-storage":0},o=[];function i(e){if(a[e])return a[e].exports;var r=a[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=a,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(r,a,function(e){return t[e]}.bind(null,a));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/static/django_airavata_workspace/dist/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],u=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var h=u;o.push([7,"chunk-vendors","chunk-common"]),r()})({"1c17":function(t,e,r){"use strict";r.r(e);var a=r("d4e1"),n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[t.userStoragePath?r("router-view",{attrs:{"user-storage-path":t.userStoragePath,"storage-path":t.storagePath,"allow-preview":!1},on:{"upload-finished":t.uploadFinished,"add-directory":t.addDirectory,"delete-dir":t.deleteDir,"delete-file":t.deleteFile,"directory-selected":t.directorySelected,"file-content-changed":t.fileContentChanged}}):t._e()],1)},o=[],i=(r("a481"),r("aef6"),r("96cf"),r("3b8d")),s=r("ac24"),u={name:"user-storage-container",computed:{dataProductUri:function(){return this.$route.query.dataProductUri}},data:function(){return{storagePath:null,userStoragePath:null}},methods:{setStoragePath:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=null,this.dataProductUri?e="~/":(e=/~.*$/.exec(this.$route.fullPath),e=e&&e.length>0?e[0]:this.$route.path),e.endsWith("/")||(e+="/"),this.storagePath=e;case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),loadUserStoragePath:function(t){var e=this,r=function(r){404===r.details.status?e.handleMissingPath(t):s["e"].FetchUtils.reportError(r)};return this.dataProductUri?s["e"].FetchUtils.get("/api/data-products?product-uri=".concat(this.dataProductUri)).then((function(t){e.userStoragePath={isDir:!1,directories:[],files:[{createdTime:t.creationTime,dataProductURI:e.dataProductUri,downloadURL:t.downloadURL,mimeType:t.productMetadata["mime-type"],name:t.productName,size:t.productSize}],parts:[]}})).catch(r):s["c"].UserStoragePathService.get({path:t},{ignoreErrors:!0}).then((function(t){e.userStoragePath=t})).catch(r)},handleMissingPath:function(t){this.$router.replace("/~/"),a["d"].NotificationList.add(new a["d"].Notification({type:"WARNING",message:"Path does not exist: "+t,duration:2}))},fileChanged:function(){var t=this;if(this.file&&!this.fileTooLarge){var e=new FormData;e.append("file",this.file),s["e"].FetchUtils.post("/api/user-storage/"+this.storagePath,e).then((function(){t.$refs["file-input"].reset(),t.loadUserStoragePath(t.storagePath)}))}},fileContentChanged:function(){this.loadUserStoragePath(this.storagePath)},uploadFinished:function(){this.loadUserStoragePath(this.storagePath)},addDirectory:function(t){var e=this;if(t){var r=this.storagePath;r.endsWith("/")||(r+="/"),r+=t,s["e"].FetchUtils.post("/api/user-storage/"+r).then((function(){e.loadUserStoragePath(e.storagePath)}))}},deleteDir:function(t){var e=this;s["e"].FetchUtils.delete("/api/user-storage/~/"+t).then((function(){e.loadUserStoragePath(e.storagePath)}))},deleteFile:function(t){var e=this;s["e"].FetchUtils.delete("/api/delete-file?data-product-uri="+encodeURIComponent(t)).then((function(){e.loadUserStoragePath(e.storagePath)}))},directorySelected:function(t){this.$router.push("/~/"+t)}},created:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("/"!==this.$route.path){t.next=5;break}return t.next=3,this.$router.replace("/~/");case 3:t.next=9;break;case 5:return t.next=7,this.setStoragePath();case 7:return t.next=9,this.loadUserStoragePath(this.storagePath);case 9:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),watch:{$route:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.setStoragePath();case 2:return t.next=4,this.loadUserStoragePath(this.storagePath);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},c=u,h=r("2877"),d=Object(h["a"])(c,n,o,!1,null,null,null),l=d.exports,f=r("ab2b"),p=r("8c4f"),g=[{path:"*",component:f["a"]}],P=new p["a"]({mode:"history",base:"/workspace/storage",routes:g});Object(a["b"])((function(t){t.use(p["a"]),new t({render:function(t){return t(a["a"].MainLayout,[t(l)])},router:P}).$mount("#user-storage")}))},7:function(t,e,r){t.exports=r("1c17")}});
//# sourceMappingURL=user-storage.1496b545.js.map