{"remainingRequest":"/home/vanishing/git/airavata-django-portal/django_airavata/apps/auth/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vanishing/git/airavata-django-portal/django_airavata/apps/auth/static/django_airavata_auth/js/containers/UserProfileContainer.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vanishing/git/airavata-django-portal/django_airavata/apps/auth/static/django_airavata_auth/js/containers/UserProfileContainer.vue","mtime":1638641844329},{"path":"/home/vanishing/git/airavata-django-portal/django_airavata/apps/auth/node_modules/babel-loader/lib/index.js","mtime":1638646261191},{"path":"/home/vanishing/git/airavata-django-portal/django_airavata/apps/auth/node_modules/cache-loader/dist/cjs.js","mtime":1638646228487},{"path":"/home/vanishing/git/airavata-django-portal/django_airavata/apps/auth/node_modules/vue-loader/lib/index.js","mtime":1638646266152}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { services } from \"django-airavata-api\";\nimport UserProfileEditor from \"../components/UserProfileEditor.vue\";\nimport { notifications } from \"django-airavata-common-ui\";\n\nexport default {\n  components: { UserProfileEditor },\n  name: \"user-profile-container\",\n  created() {\n    services.UserService.current()\n      .then((user) => {\n        this.user = user;\n      })\n      .then(() => {\n        const queryParams = new URLSearchParams(window.location.search);\n        if (queryParams.has(\"code\")) {\n          this.verifyEmailChange(queryParams.get(\"code\"));\n        }\n      });\n  },\n  data() {\n    return {\n      user: null,\n    };\n  },\n  methods: {\n    onSave(value) {\n      services.UserService.update({\n        lookup: value.id,\n        data: value,\n      }).then((user) => {\n        notifications.NotificationList.add(\n          new notifications.Notification({\n            type: \"SUCCESS\",\n            message: \"User profile saved\",\n            duration: 5,\n          })\n        );\n        this.user = user;\n      });\n    },\n    resendEmailVerification() {\n      services.UserService.resendEmailVerification({\n        lookup: this.user.id,\n      }).then(() => {\n        notifications.NotificationList.add(\n          new notifications.Notification({\n            type: \"SUCCESS\",\n            message: \"Verification link sent\",\n            duration: 5,\n          })\n        );\n      });\n    },\n    verifyEmailChange(code) {\n      services.UserService.verifyEmailChange({\n        lookup: this.user.id,\n        data: { code: code },\n      }).then((user) => {\n        // User now updated with email change\n        this.user = user;\n        notifications.NotificationList.add(\n          new notifications.Notification({\n            type: \"SUCCESS\",\n            message: \"Email address verified and updated\",\n            duration: 5,\n          })\n        );\n        // Update URL, removing the code from the query string\n        window.history.replaceState({}, \"\", \"/auth/user-profile/\");\n      });\n    },\n  },\n};\n",{"version":3,"sources":["UserProfileContainer.vue"],"names":[],"mappings":";;;;;;;;;;;;;AAaA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"UserProfileContainer.vue","sourceRoot":"static/django_airavata_auth/js/containers","sourcesContent":["<template>\n  <div>\n    <h1 class=\"h4 mb-4\">User Profile Editor</h1>\n    <user-profile-editor\n      v-if=\"user\"\n      v-model=\"user\"\n      @save=\"onSave\"\n      @resend-email-verification=\"resendEmailVerification\"\n    />\n  </div>\n</template>\n\n<script>\nimport { services } from \"django-airavata-api\";\nimport UserProfileEditor from \"../components/UserProfileEditor.vue\";\nimport { notifications } from \"django-airavata-common-ui\";\n\nexport default {\n  components: { UserProfileEditor },\n  name: \"user-profile-container\",\n  created() {\n    services.UserService.current()\n      .then((user) => {\n        this.user = user;\n      })\n      .then(() => {\n        const queryParams = new URLSearchParams(window.location.search);\n        if (queryParams.has(\"code\")) {\n          this.verifyEmailChange(queryParams.get(\"code\"));\n        }\n      });\n  },\n  data() {\n    return {\n      user: null,\n    };\n  },\n  methods: {\n    onSave(value) {\n      services.UserService.update({\n        lookup: value.id,\n        data: value,\n      }).then((user) => {\n        notifications.NotificationList.add(\n          new notifications.Notification({\n            type: \"SUCCESS\",\n            message: \"User profile saved\",\n            duration: 5,\n          })\n        );\n        this.user = user;\n      });\n    },\n    resendEmailVerification() {\n      services.UserService.resendEmailVerification({\n        lookup: this.user.id,\n      }).then(() => {\n        notifications.NotificationList.add(\n          new notifications.Notification({\n            type: \"SUCCESS\",\n            message: \"Verification link sent\",\n            duration: 5,\n          })\n        );\n      });\n    },\n    verifyEmailChange(code) {\n      services.UserService.verifyEmailChange({\n        lookup: this.user.id,\n        data: { code: code },\n      }).then((user) => {\n        // User now updated with email change\n        this.user = user;\n        notifications.NotificationList.add(\n          new notifications.Notification({\n            type: \"SUCCESS\",\n            message: \"Email address verified and updated\",\n            duration: 5,\n          })\n        );\n        // Update URL, removing the code from the query string\n        window.history.replaceState({}, \"\", \"/auth/user-profile/\");\n      });\n    },\n  },\n};\n</script>\n\n<style></style>\n"]}]}